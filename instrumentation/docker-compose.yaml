# this was mostly copied from the official example: https://github.com/grafana/tempo/blob/main/example/docker-compose/local/docker-compose.yaml

version: '3.9'

networks:
  thespian_instrumentation:

services:
  grafana:
    image: grafana/grafana:9.4.7
    networks:
      - thespian_instrumentation
    ports:
      - 3000:3000 # default grafana port
    volumes:
      - ./grafana:/etc/grafana/provisioning/datasources

  loki:
    image: grafana/loki:2.7.4
    networks:
      - thespian_instrumentation
    ports:
      - 3100:3100 # default loki port
    command: -config.file=/etc/loki/local-config.yaml # this file is built into the image

  tempo:
    image: grafana/tempo:2.0.1
    networks:
      - thespian_instrumentation
    ports:
      - 3200:3200  # default tempo port (seems to be for queries)
      - 4317:4317  # default otlp grpc port (seems to be for ingestion)
    volumes:
      - ./tempo:/etc/tempo
    command: -config.file=/etc/tempo/config.yaml